services:
  backend:
    build:
      context: ./backend
    env_file:
      - .env
    environment:
      PORT: ${BACKEND_PORT:-8080}
      KASPA_RPC_TARGET: ${KASPA_RPC_TARGET}
      KASPA_NETWORK: ${KASPA_NETWORK:-testnet-10}
      KASPA_ALLOWED_ADDRESS_PREFIXES: ${KASPA_ALLOWED_ADDRESS_PREFIXES:-kaspatest,kaspa}
      REDIS_URL: ${REDIS_URL:-redis://redis:6379}
      JWT_SECRET: ${JWT_SECRET:-change-me-in-production}
      ALLOW_UNVERIFIED_WALLET_SIG: ${ALLOW_UNVERIFIED_WALLET_SIG:-true}
      PLATFORM_FEE_ENABLED: ${PLATFORM_FEE_ENABLED:-true}
      PLATFORM_FEE_BPS: ${PLATFORM_FEE_BPS:-100}
      PLATFORM_FEE_MIN_KAS: ${PLATFORM_FEE_MIN_KAS:-0.01}
      PLATFORM_FEE_RECIPIENT: ${PLATFORM_FEE_RECIPIENT:-kaspa:qpv7fcvdlz6th4hqjtm9qkkms2dw0raem963x3hm8glu3kjgj7922vy69hv85}
      CORS_ORIGIN: http://localhost:${FRONTEND_PORT:-3000}
    ports:
      - "${BACKEND_PORT:-8080}:8080"
    depends_on:
      - redis

  frontend:
    build:
      context: ./frontend
    ports:
      - "${FRONTEND_PORT:-3000}:80"
    depends_on:
      - backend

  redis:
    image: redis:7-alpine
    command: ["redis-server", "--save", "", "--appendonly", "no"]
